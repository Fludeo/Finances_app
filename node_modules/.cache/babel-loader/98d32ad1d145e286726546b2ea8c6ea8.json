{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/noah1/Documents/GitHub/Finances_app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"C:/Users/noah1/Documents/GitHub/Finances_app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/noah1/Documents/GitHub/Finances_app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\noah1\\\\Documents\\\\GitHub\\\\Finances_app\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState}from'react';import'../styles/login_page/login_page.css';import{FaMoneyBillWave}from'react-icons/fa';import{RiDatabase2Fill}from'react-icons/ri';import{useNavigate}from\"react-router-dom\";import Modal from'../common/Modal';import SignupForm from'./SignupForm';import LoginForm from'./LoginForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginPage=function LoginPage(_ref){var setAccessToken=_ref.setAccessToken,token=_ref.token;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),loginForm=_useState2[0],setLoginForm=_useState2[1];var _useState3=useState({password:'',repeatPassword:''}),_useState4=_slicedToArray(_useState3,2),signupForm=_useState4[0],setSignupForm=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modalTrigger=_useState6[0],setModalTrigger=_useState6[1];var navigate=useNavigate();//check if user is Logged\nif(token!=='')navigate('/logged/home',{replace:true});var closeSignupModal=function closeSignupModal(){setSignupForm(_objectSpread(_objectSpread({},signupForm),{},{errorMessage:''}));setModalTrigger(false);};var _handleLogin=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var rawResponse,content;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return fetch(\"\".concat(process.env.REACT_APP_PUBLIC_URL_API,\"/auth/login\"),{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify(loginForm)});case 4:rawResponse=_context.sent;_context.next=7;return rawResponse.json();case 7:content=_context.sent;if(!rawResponse.ok){_context.next=13;break;}setAccessToken(content.accessToken);navigate('/logged/home');_context.next=15;break;case 13:setLoginForm(_objectSpread(_objectSpread({},loginForm),{},{errorMessage:content.message}));throw new Error(content.message);case 15:_context.next=21;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](1);console.log(_context.t0);navigate('/');case 21:case\"end\":return _context.stop();}}},_callee,null,[[1,17]]);}));return function handleLogin(_x){return _ref2.apply(this,arguments);};}();var _handleSignup=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var rawResponse,content;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();if(!(signupForm.password!==signupForm.repeatPassword)){_context2.next=4;break;}setSignupForm(_objectSpread(_objectSpread({},signupForm),{},{errorMessage:'Passwords fields do not match'}));return _context2.abrupt(\"return\");case 4:_context2.prev=4;_context2.next=7;return fetch(\"\".concat(process.env.REACT_APP_PUBLIC_URL_API,\"/user/signup\"),{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify(signupForm)});case 7:rawResponse=_context2.sent;if(!rawResponse.ok){_context2.next=13;break;}setModalTrigger(false);navigate('/');_context2.next=18;break;case 13:_context2.next=15;return rawResponse.json();case 15:content=_context2.sent;setSignupForm(_objectSpread(_objectSpread({},signupForm),{},{errorMessage:content.message}));throw new Error(content.message);case 18:_context2.next=23;break;case 20:_context2.prev=20;_context2.t0=_context2[\"catch\"](4);console.log(_context2.t0);case 23:case\"end\":return _context2.stop();}}},_callee2,null,[[4,20]]);}));return function handleSignup(_x2){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"login-page\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"login-page__section-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"title__title\",children:\"Alkemy\"}),/*#__PURE__*/_jsx(RiDatabase2Fill,{className:\"title__icon\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"login-page__section-text\",children:[\"Keep track of your \",/*#__PURE__*/_jsx(\"span\",{className:\"login-page__span\",children:\"finances\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setModalTrigger(true);},className:\"login-page__signup-button login-page__signup-button--hover\",children:\"Sign Up\"})]}),/*#__PURE__*/_jsx(\"section\",{className:\"login-page__section-login\",children:/*#__PURE__*/_jsx(LoginForm,{handleLogin:function handleLogin(e){return _handleLogin(e);},UpdateForm:function UpdateForm(payload){return setLoginForm(_objectSpread(_objectSpread({},payload),{},{errorMessage:''}));},formFields:loginForm})}),/*#__PURE__*/_jsx(FaMoneyBillWave,{className:\"login-page__bottom-bill\"}),/*#__PURE__*/_jsx(FaMoneyBillWave,{className:\"login-page__top-bill\"}),/*#__PURE__*/_jsx(FaMoneyBillWave,{className:\"login-page__middle-bill\"}),/*#__PURE__*/_jsx(Modal,{trigger:modalTrigger,children:/*#__PURE__*/_jsx(SignupForm,{closeSignup:function closeSignup(){return closeSignupModal();},UpdateForm:function UpdateForm(payload){return setSignupForm(_objectSpread(_objectSpread({},payload),{},{errorMessage:''}));},formFields:signupForm,handleSignup:function handleSignup(e){return _handleSignup(e);}})})]});};export default LoginPage;","map":{"version":3,"sources":["C:/Users/noah1/Documents/GitHub/Finances_app/src/components/login_page/LoginPage.tsx"],"names":["React","useState","FaMoneyBillWave","RiDatabase2Fill","useNavigate","Modal","SignupForm","LoginForm","LoginPage","setAccessToken","token","loginForm","setLoginForm","password","repeatPassword","signupForm","setSignupForm","modalTrigger","setModalTrigger","navigate","replace","closeSignupModal","errorMessage","handleLogin","e","preventDefault","fetch","process","env","REACT_APP_PUBLIC_URL_API","method","headers","body","JSON","stringify","rawResponse","json","content","ok","accessToken","message","Error","console","log","handleSignup","payload"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport '../styles/login_page/login_page.css'\r\nimport {FaMoneyBillWave} from 'react-icons/fa'\r\nimport { RiDatabase2Fill } from 'react-icons/ri'\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport {LoginFormType, SignFormType }from '../../types/types'\r\nimport Modal from '../common/Modal';\r\nimport SignupForm from './SignupForm';\r\nimport LoginForm from './LoginForm'\r\n\r\n\r\ntype props = {\r\n    setAccessToken:(token:string)=>void\r\n    token:string\r\n}   \r\n\r\nconst LoginPage = ({setAccessToken,token}:props) => {\r\n  const [loginForm, setLoginForm]  = useState<LoginFormType>({}as LoginFormType)\r\n  const [signupForm,setSignupForm]  = useState<SignFormType>({password:'' ,repeatPassword:''}as SignFormType)\r\n  const [modalTrigger,setModalTrigger] = useState<boolean> (false)\r\n  const navigate = useNavigate()\r\n\r\n  //check if user is Logged\r\n  if(token!=='') navigate('/logged/home',{replace: true})\r\n\r\n\r\n\r\nconst closeSignupModal= () =>{\r\n        setSignupForm({...signupForm, errorMessage:''})\r\n        setModalTrigger(false)\r\n  }\r\n\r\n\r\nconst handleLogin = async (e:React.MouseEvent<HTMLButtonElement, MouseEvent>) =>{\r\n    e.preventDefault()\r\n    try{\r\n        const rawResponse = await fetch(`${process.env.REACT_APP_PUBLIC_URL_API}/auth/login`, {\r\n            method: 'POST',\r\n            headers: {\r\n              'Accept': 'application/json',\r\n              'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(loginForm)\r\n          });\r\n          \r\n          const content = await rawResponse.json()\r\n          if(rawResponse.ok){\r\n          setAccessToken(content.accessToken)\r\n          navigate('/logged/home')\r\n            }\r\n        else{\r\n          \r\n            setLoginForm({...loginForm, errorMessage:content.message})\r\n            throw new Error(content.message)\r\n           }\r\n        }\r\n        catch(err){\r\n            console.log(err)\r\n            navigate('/')\r\n        }\r\n        }\r\n\r\n\r\nconst handleSignup = async (e:React.MouseEvent<HTMLButtonElement, MouseEvent>) =>{\r\n            e.preventDefault()\r\n            if(signupForm.password!==signupForm.repeatPassword){\r\n              setSignupForm({...signupForm, errorMessage:'Passwords fields do not match'})\r\n              return\r\n            }\r\n            try{\r\n                const rawResponse = await fetch(`${process.env.REACT_APP_PUBLIC_URL_API}/user/signup`, {\r\n                    method: 'POST',\r\n                    headers: {\r\n                      'Accept': 'application/json',\r\n                      'Content-Type': 'application/json'\r\n                    },\r\n                    body: JSON.stringify(signupForm)\r\n                  }); \r\n                  if(rawResponse.ok){\r\n               \r\n                  setModalTrigger(false)\r\n                  navigate('/')\r\n                }\r\n                else{\r\n                    const content = await rawResponse.json()\r\n                    setSignupForm({...signupForm, errorMessage:content.message})\r\n                    throw new Error(content.message)\r\n                }\r\n                }\r\n                catch(err){\r\n                    console.log(err)\r\n                }\r\n        }\r\n         \r\n        \r\n\r\n\r\n\r\n    return(\r\n     <div className=\"login-page\">\r\n         <section className=\"login-page__section-header\">\r\n        <div className='title'> \r\n            <h1 className='title__title'>Alkemy</h1>\r\n            <RiDatabase2Fill  className='title__icon'></RiDatabase2Fill>\r\n        </div>\r\n\r\n         <p className='login-page__section-text'>Keep track of your <span className='login-page__span'>finances</span></p>\r\n         <button onClick={()=>setModalTrigger(true)} className='login-page__signup-button login-page__signup-button--hover'>Sign Up</button>\r\n        </section>\r\n\r\n         <section className=\"login-page__section-login\">\r\n            <LoginForm  handleLogin={(e)=>handleLogin(e)} UpdateForm={(payload:LoginFormType ) => setLoginForm({...payload ,errorMessage:''}) } \r\n            formFields={loginForm}></LoginForm>\r\n         </section>\r\n        <FaMoneyBillWave  className='login-page__bottom-bill'></FaMoneyBillWave>\r\n        <FaMoneyBillWave  className='login-page__top-bill'></FaMoneyBillWave>\r\n        <FaMoneyBillWave  className='login-page__middle-bill'></FaMoneyBillWave>\r\n        <Modal  trigger={modalTrigger}>\r\n             <SignupForm \r\n             closeSignup={()=>closeSignupModal()}\r\n             UpdateForm={(payload:SignFormType)=>setSignupForm({...payload ,errorMessage:''})} \r\n             formFields={signupForm} handleSignup={(e)=>handleSignup(e)}></SignupForm>\r\n        </Modal>\r\n    </div>)\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\nexport default LoginPage"]},"metadata":{},"sourceType":"module"}